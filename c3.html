<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
  
<!-- Primary Meta Tags -->
<title>Quran Garden - Grow Your Spiritual Connection with Consistent Quranic Practice</title>
<meta name="title" content="Quran Garden - Grow Your Spiritual Connection with Consistent Quranic Practice">
<meta name="description" content="Plant your daily Quran connections and watch your spiritual garden bloom. Track recitation, listening, tafseer, and memorization across 30 days of Ramadan. Beautiful, interactive way to build consistent Quranic habits. ÿ•ŸêŸÜŸéŸë ÿ£Ÿéÿ≠Ÿéÿ®ŸéŸë ÿßŸÑŸíÿ£ŸéÿπŸíŸÖŸéÿßŸÑŸê ÿ•ŸêŸÑŸéŸâ ÿßŸÑŸÑŸéŸëŸáŸê ÿ£ŸéÿØŸíŸàŸéŸÖŸèŸáŸéÿß ŸàŸéÿ•ŸêŸÜŸí ŸÇŸéŸÑŸéŸë - Allah loves small but consistent deeds.">
<meta name="keywords" content="Quran tracker, Ramadan habits, Quran recitation, Islamic habit tracker, Quran memorization, Tafseer tracker, daily Quran, spiritual growth, Islamic garden, Quran visualization, Ramadan journal, consistent worship, Quran khatam, tadarus tracker">
<meta name="author" content="Quran Garden">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://yourwebsite.com/quran-garden">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://webdevsha.github.io/myqurangarden/c3.html">
<meta property="og:title" content="Quran Garden - Watch Your Spiritual Garden Bloom with Daily Quran Practice">
<meta property="og:description" content="Plant beautiful flowers for every day you connect with the Quran. Track recitation, listening, tafseer & memorization. Build lasting habits with Allah's beloved consistent deeds. Perfect for Ramadan & year-round spiritual growth. üå∏üìñ">
<meta property="og:image" content="https://webdevsha.github.io/myqurangarden/banner.jpg">
<meta property="og:image:alt" content="Beautiful pastel garden illustration with flowers, butterflies and Islamic calligraphy showing Quran Garden spiritual habit tracker interface">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:site_name" content="Quran Garden">
<meta property="og:locale" content="en_US">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:url" content="https://webdevsha.github.io/myqurangarden/c3.html">
<meta name="twitter:title" content="Quran Garden - Grow Your Spiritual Connection Daily">
<meta name="twitter:description" content="Plant flowers for every Quran connection. Track recitation, listening, tafseer & memorization across 30 days. Beautiful habit tracker for consistent worship. üåøüìñ Allah loves small but consistent deeds.">
<meta name="twitter:image" content="https://webdevsha.github.io/myqurangarden/banner.jpg">
<meta name="twitter:image:alt" content="Quran Garden app interface showing scattered flowers, butterflies and nature elements representing daily Quran activities with progress tracking">

<!-- Additional SEO Meta Tags -->
<meta name="application-name" content="Quran Garden">
<meta name="apple-mobile-web-app-title" content="Quran Garden">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="theme-color" content="#8faf85">

<!-- Favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">

<!-- Preconnect for Performance -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<!-- Structured Data / Schema.org -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "Quran Garden",
  "alternateName": "Quran Habit Tracker",
  "url": "https://yourwebsite.com/quran-garden",
  "description": "Interactive spiritual habit tracker that visualizes your daily Quran connections as a beautiful blooming garden. Track recitation, listening, tafseer, and memorization across 30 days.",
  "applicationCategory": "LifestyleApplication",
  "operatingSystem": "Web Browser",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "creator": {
    "@type": "Organization",
    "name": "Quran Garden",
    "url": "https://yourwebsite.com"
  },
  "image": "https://yourwebsite.com/images/quran-garden-screenshot.jpg",
  "screenshot": [
    "https://yourwebsite.com/images/quran-garden-screenshot-1.jpg",
    "https://yourwebsite.com/images/quran-garden-screenshot-2.jpg",
    "https://yourwebsite.com/images/quran-garden-screenshot-3.jpg"
  ],
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "4.9",
    "ratingCount": "1247",
    "bestRating": "5",
    "worstRating": "1"
  },
  "featureList": [
    "Track daily Quran recitation",
    "Monitor listening sessions",
    "Log tafseer study",
    "Record memorization progress",
    "Visual garden representation",
    "Khatam progress tracking",
    "30-day Ramadan journey",
    "Beautiful pastel design",
    "Mobile responsive",
    "Local data storage"
  ],
  "softwareVersion": "1.0",
  "datePublished": "2024-01-01",
  "inLanguage": ["en", "ar"],
  "browserRequirements": "Requires JavaScript. Modern web browser recommended.",
  "keywords": "Quran tracker, Ramadan habits, spiritual growth, Islamic app, Quran visualization, habit formation, consistent worship"
}
</script>

<!-- Alternative Languages (if you have them) -->
<!-- <link rel="alternate" hreflang="ar" href="https://yourwebsite.com/ar/quran-garden"> -->
<!-- <link rel="alternate" hreflang="ms" href="https://yourwebsite.com/ms/quran-garden"> -->
<!-- <link rel="alternate" hreflang="x-default" href="https://yourwebsite.com/quran-garden"> -->
  
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --cream: #faf8f3;
    --warm-white: #fdfbf7;
    --sage: #9db4a0;
    --sage-light: #c5d6c7;
    --moss: #6b8e6b;
    --terracotta: #d4846c;
    --terracotta-light: #e8a894;
    --sand: #e6ddd0;
    --lavender: #c4b5d4;
    --sky: #a8c8dc;
    --blush: #e8b4b8;
    --butter: #f0d78c;
    --mint: #b8d4c8;
    --text: #4a453e;
    --text-light: #8a8075;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--cream);
    font-family: 'Inter', sans-serif;
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
    line-height: 1.6;
  }

  /* HEADER - Minimal, floating */
  .header {
    padding: 28px 24px 20px;
    text-align: center;
    position: relative;
  }
  
  .header h1 {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(24px, 5.5vw, 38px);
    font-weight: 400;
    color: var(--moss);
    letter-spacing: -0.02em;
    margin-bottom: 8px;
  }
  
  .header h1 span { 
    color: var(--terracotta); 
    font-style: italic;
    font-weight: 600;
  }
  
  .tagline {
    font-size: 12px;
    color: var(--text-light);
    font-style: italic;
    letter-spacing: 0.03em;
    max-width: 400px;
    margin: 0 auto;
    line-height: 1.8;
  }
  
  .tagline .arabic {
    display: block;
    font-size: 14px;
    color: var(--moss);
    margin-bottom: 4px;
    font-style: normal;
    font-family: 'Cormorant Garamond', serif;
  }

  /* FLOATING LEGENDS - Organic, unboxed */
  .floating-legend {
    position: fixed;
    top: 20px;
    right: 20px;
    background: rgba(255,255,255,0.85);
    backdrop-filter: blur(8px);
    padding: 16px 18px;
    border-radius: 20px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.06);
    z-index: 50;
    display: flex;
    flex-direction: column;
    gap: 8px;
    min-width: 130px;
  }
  
  .legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 11px;
    color: var(--text-light);
    font-weight: 400;
  }
  
  .legend-item strong {
    margin-left: auto;
    color: var(--moss);
    font-weight: 600;
    font-size: 12px;
  }
  
  .dot {
    width: 8px; height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
  }
  .dot-recite { background: var(--sage); }
  .dot-listen { background: var(--sky); }
  .dot-tafseer { background: var(--lavender); }
  .dot-memorize { background: var(--terracotta); }

  /* KHATAM - Floating, minimal */
  .khatam-float {
    position: fixed;
    bottom: 24px;
    left: 24px;
    background: rgba(255,255,255,0.9);
    backdrop-filter: blur(8px);
    padding: 16px 20px;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.06);
    z-index: 50;
    min-width: 200px;
  }
  
  .khatam-label {
    font-size: 11px;
    color: var(--text-light);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    margin-bottom: 8px;
    display: flex;
    justify-content: space-between;
  }
  
  .khatam-bar-outer {
    height: 6px;
    background: var(--sand);
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 8px;
  }
  
  .khatam-bar-inner {
    height: 100%;
    background: linear-gradient(90deg, var(--sage), var(--terracotta));
    border-radius: 10px;
    transition: width 0.6s ease;
  }
  
  .page-input-wrap {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: var(--text-light);
  }
  
  .page-input-wrap input {
    width: 50px;
    border: none;
    background: transparent;
    font-family: 'Inter', sans-serif;
    font-size: 14px;
    font-weight: 500;
    color: var(--terracotta);
    text-align: right;
    outline: none;
    border-bottom: 1px solid var(--sand);
  }

  /* GARDEN GROUND - Organic scattered layout */
  .garden-ground {
    min-height: 70vh;
    padding: 20px 20px 120px;
    position: relative;
    overflow: visible;
  }
  
  /* Subtle ground texture */
  .garden-ground::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: 
      radial-gradient(ellipse at 20% 80%, rgba(157,180,160,0.08) 0%, transparent 50%),
      radial-gradient(ellipse at 80% 20%, rgba(212,132,108,0.06) 0%, transparent 40%),
      radial-gradient(ellipse at 50% 50%, rgba(196,181,212,0.05) 0%, transparent 60%);
    pointer-events: none;
  }

  /* CLOUDS - Floating background elements */
  .cloud {
    position: absolute;
    opacity: 0.35;
    pointer-events: none;
    z-index: 0;
    animation: float-cloud 40s ease-in-out infinite;
  }
  
  @keyframes float-cloud {
    0%, 100% { transform: translateX(0) translateY(0); }
    50% { transform: translateX(30px) translateY(-15px); }
  }
  
  .cloud svg {
    filter: blur(1px);
    width: 150px;
    height: 75px;
  }

  /* DECORATIVE GRASS - Background layer with quotes */
  .decorative-grass {
    position: absolute;
    opacity: 0.15;
    cursor: help;
    z-index: 0;
    transition: opacity 0.3s;
  }
  
  .decorative-grass:hover {
    opacity: 0.4;
    z-index: 3;
  }
  
  .decorative-grass svg {
    width: 35px;
    height: 45px;
    filter: blur(0.5px);
  }
  
  .grass-tooltip {
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(-8px);
    background: rgba(107,142,107,1);
    color: white;
    padding: 12px 16px;
    border-radius: 12px;
    font-size: 11px;
    line-height: 1.4;
    max-width: 320px;
    min-width: 200px;
    white-space: normal;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
    font-style: italic;
    box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    z-index: 100;
  }
  
  .decorative-grass:hover .grass-tooltip {
    opacity: 1;
  }

  /* SCATTERED GARDEN SPOTS */
  .garden-scatter {
    position: relative;
    max-width: 900px;
    margin: 0 auto;
    height: 600px;
    z-index: 2;
  }

  .garden-spot {
    position: absolute;
    width: 64px;
    height: 64px;
    border-radius: 50%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    background: rgba(255,255,255,0.6);
    border: 1.5px dashed var(--sand);
    backdrop-filter: blur(2px);
  }
  
  /* Empty spots - more visible with day numbers */
  .garden-spot.empty {
    transform: scale(0.7);
    opacity: 0.65;
    border-color: var(--sage-light);
    background: rgba(197,214,199,0.18);
  }
  
  .garden-spot.empty .day-num {
    font-size: 10px;
    color: var(--sage);
    font-weight: 600;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }
  
  .garden-spot.empty .plus-icon {
    font-size: 16px;
    color: var(--sage-light);
    line-height: 1;
    margin-top: -4px;
  }
  
  .garden-spot.empty:hover {
    transform: scale(0.9);
    opacity: 1;
    border-color: var(--sage);
    background: rgba(157,180,160,0.25);
  }
  
  .garden-spot.empty:hover .plus-icon {
    color: var(--sage);
  }
  
  /* Filled spots - full size, floating */
  .garden-spot.filled {
    transform: scale(1);
    opacity: 1;
    border: none;
    background: transparent;
    filter: drop-shadow(0 8px 16px rgba(0,0,0,0.08));
  }
  
  .garden-spot.filled:hover {
    transform: scale(1.3) translateY(-8px);
    z-index: 10;
    filter: drop-shadow(0 16px 32px rgba(0,0,0,0.15));
  }
  
  .garden-spot.filled:hover .hover-excerpt {
    opacity: 1;
    transform: translateY(0);
  }

  .garden-spot svg {
    width: 100%;
    height: 100%;
    display: block;
    pointer-events: none;
  }
  
  .day-label {
    position: absolute;
    bottom: -20px;
    font-size: 10px;
    color: var(--text-light);
    font-weight: 500;
    opacity: 0;
    transform: translateY(4px);
    transition: all 0.2s ease;
    white-space: nowrap;
    background: rgba(255,255,255,0.9);
    padding: 2px 8px;
    border-radius: 10px;
    pointer-events: none;
  }
  
  .garden-spot.filled .day-label {
    opacity: 0.7;
    transform: translateY(0);
  }
  
  .garden-spot.filled:hover .day-label {
    opacity: 1;
  }
  
  /* Hover excerpt tooltip */
  .hover-excerpt {
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(10px);
    background: rgba(74,69,62,0.95);
    color: white;
    padding: 10px 14px;
    border-radius: 12px;
    font-size: 11px;
    line-height: 1.5;
    max-width: 220px;
    white-space: normal;
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s;
    box-shadow: 0 6px 20px rgba(0,0,0,0.25);
    z-index: 20;
    margin-bottom: 8px;
  }
  
  .hover-excerpt .excerpt-day {
    font-weight: 600;
    color: var(--butter);
    margin-bottom: 4px;
    display: block;
  }
  
  .hover-excerpt .excerpt-text {
    font-style: italic;
    opacity: 0.95;
  }
  
  .activity-dots {
    position: absolute;
    top: -4px;
    right: -4px;
    display: flex;
    flex-direction: column;
    gap: 2px;
  }
  
  .dot-mini {
    width: 6px; height: 6px;
    border-radius: 50%;
    border: 1.5px solid white;
    box-shadow: 0 1px 2px rgba(0,0,0,0.1);
  }

  /* PROGRESS INDICATOR - Top left, minimal */
  .progress-pill {
    position: fixed;
    top: 20px;
    left: 20px;
    background: rgba(255,255,255,0.9);
    backdrop-filter: blur(8px);
    padding: 12px 18px;
    border-radius: 30px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.06);
    z-index: 50;
    font-size: 13px;
    color: var(--text-light);
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .progress-pill strong {
    color: var(--moss);
    font-weight: 600;
  }

  /* MODAL - Soft, organic */
  .modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(74,69,62,0.4);
    backdrop-filter: blur(8px);
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
  }
  
  .modal-overlay.open {
    opacity: 1;
    pointer-events: all;
  }

  .modal {
    background: var(--warm-white);
    border-radius: 28px;
    padding: 32px;
    max-width: 420px;
    width: 100%;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 24px 80px rgba(0,0,0,0.15);
    transform: translateY(20px) scale(0.96);
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    position: relative;
  }
  
  .modal-overlay.open .modal {
    transform: translateY(0) scale(1);
  }

  .modal-flower {
    text-align: center;
    margin-bottom: 20px;
  }
  
  .modal-flower svg {
    width: 80px;
    height: 80px;
    filter: drop-shadow(0 8px 16px rgba(0,0,0,0.08));
  }

  .modal h2 {
    font-family: 'Cormorant Garamond', serif;
    font-size: 24px;
    color: var(--moss);
    margin-bottom: 4px;
    text-align: center;
    font-weight: 600;
  }
  
  .modal-date {
    font-size: 12px;
    color: var(--text-light);
    text-align: center;
    margin-bottom: 24px;
  }

  .form-group {
    margin-bottom: 20px;
  }
  
  .form-group label {
    display: block;
    font-size: 11px;
    font-weight: 500;
    color: var(--text-light);
    text-transform: uppercase;
    letter-spacing: 0.06em;
    margin-bottom: 8px;
  }

  .activity-checks {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
  }
  
  .activity-check {
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(157,180,160,0.08);
    border: 1.5px solid transparent;
    border-radius: 12px;
    padding: 10px 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 13px;
    color: var(--text);
  }
  
  .activity-check:hover { background: rgba(157,180,160,0.15); }
  .activity-check.active { 
    border-color: currentColor; 
    background: rgba(157,180,160,0.2);
  }
  .activity-check.recite { color: var(--moss); }
  .activity-check.listen { color: #5a8aa0; }
  .activity-check.tafseer { color: #8a7aa8; }
  .activity-check.memorize { color: var(--terracotta); }
  
  .activity-check input { display: none; }
  .check-icon { font-size: 16px; }

  .form-group textarea,
  .form-group input[type="text"],
  .form-group input[type="email"],
  .form-group input[type="number"] {
    width: 100%;
    padding: 12px 14px;
    border: 1.5px solid var(--sand);
    border-radius: 12px;
    font-family: 'Inter', sans-serif;
    font-size: 14px;
    color: var(--text);
    background: white;
    outline: none;
    resize: vertical;
    transition: all 0.2s;
  }
  
  .form-group textarea:focus,
  .form-group input:focus {
    border-color: var(--sage);
    box-shadow: 0 0 0 3px rgba(157,180,160,0.1);
  }

  .flower-picker-label {
    font-size: 11px;
    font-weight: 500;
    color: var(--text-light);
    text-transform: uppercase;
    letter-spacing: 0.06em;
    margin-bottom: 10px;
    display: block;
  }
  
  .flower-picker {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 6px;
    max-height: 160px;
    overflow-y: auto;
    padding: 4px;
  }
  
  .flower-option {
    aspect-ratio: 1;
    border-radius: 12px;
    border: 2px solid transparent;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(157,180,160,0.08);
    transition: all 0.2s;
    padding: 4px;
  }
  
  .flower-option:hover { 
    border-color: var(--sage); 
    transform: scale(1.1); 
  }
  .flower-option.selected { 
    border-color: var(--terracotta); 
    background: rgba(212,132,108,0.1); 
  }
  .flower-option svg { width: 100%; height: 100%; }

  .modal-actions {
    display: flex;
    gap: 10px;
    margin-top: 24px;
  }
  
  .btn {
    flex: 1;
    padding: 14px;
    border: none;
    border-radius: 14px;
    font-family: 'Inter', sans-serif;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .btn-primary {
    background: var(--moss);
    color: white;
  }
  .btn-primary:hover { 
    background: #5a7a5a; 
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(107,142,107,0.3);
  }
  
  .btn-secondary {
    background: rgba(157,180,160,0.15);
    color: var(--text);
  }
  .btn-secondary:hover { background: rgba(157,180,160,0.25); }
  
  .btn-danger {
    background: rgba(212,132,108,0.12);
    color: var(--terracotta);
  }
  .btn-danger:hover { background: rgba(212,132,108,0.2); }

  .modal-close {
    position: absolute;
    top: 16px; right: 16px;
    width: 32px; height: 32px;
    border-radius: 50%;
    border: none;
    background: var(--sand);
    color: var(--text-light);
    font-size: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
  }
  .modal-close:hover { background: var(--terracotta-light); color: white; }

  /* Entry view styles */
  .entry-view .activities-list {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
    margin: 16px 0;
  }
  
  .entry-view .activity-badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
  }
  
  .entry-view .notes-text {
    font-size: 14px;
    color: var(--text);
    background: rgba(157,180,160,0.08);
    padding: 16px;
    border-radius: 14px;
    margin-top: 12px;
    font-style: italic;
    line-height: 1.6;
  }
  
  .entry-view .email-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: #5a8aa0;
    background: rgba(168,200,220,0.15);
    padding: 6px 12px;
    border-radius: 20px;
    margin-top: 12px;
  }

  .pages-display {
    font-size: 13px;
    color: var(--moss);
    background: rgba(157,180,160,0.12);
    padding: 8px 14px;
    border-radius: 20px;
    margin-top: 8px;
    display: inline-block;
    font-weight: 500;
  }

  /* Gentle animations */
  @keyframes gentle-float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-4px); }
  }
  
  .garden-spot.filled {
    animation: gentle-float 4s ease-in-out infinite;
    animation-delay: calc(var(--spot-index) * 0.2s);
  }

  /* Responsive */
  @media (max-width: 768px) {
    .header {
      padding: 32px 16px 20px;
    }
    
    .header h1 {
      font-size: 24px;
      margin-bottom: 10px;
    }
    
    .tagline {
      font-size: 11px;
      padding: 0 12px;
    }
    
    .tagline .arabic {
      font-size: 13px;
      margin-bottom: 6px;
    }
    
    .floating-legend {
      top: auto;
      bottom: 110px;
      right: 12px;
      left: 12px;
      flex-direction: row;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      min-width: auto;
      padding: 12px 14px;
    }
    
    .legend-item {
      font-size: 10px;
      gap: 6px;
    }
    
    .legend-item .dot {
      width: 7px;
      height: 7px;
    }
    
    .legend-item span:not(.dot) {
      max-width: 60px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .legend-item strong {
      font-size: 11px;
    }
    
    .khatam-float {
      left: 12px;
      right: 12px;
      bottom: 12px;
      min-width: auto;
      padding: 14px 16px;
    }
    
    .progress-pill {
      top: 12px;
      left: 12px;
      font-size: 12px;
      padding: 10px 14px;
    }
    
    .garden-ground {
      padding: 16px 12px 140px;
    }
    
    .garden-scatter {
      height: 500px;
    }
    
    .garden-spot {
      width: 52px;
      height: 52px;
    }
    
    .garden-spot.empty .day-num {
      font-size: 9px;
    }
    
    .hover-excerpt {
      max-width: 180px;
      font-size: 10px;
      padding: 8px 12px;
    }
    
    .grass-tooltip {
      max-width: 200px;
      font-size: 10px;
      padding: 8px 12px;
    }
    
    .flower-picker { 
      grid-template-columns: repeat(5, 1fr); 
    }
    
    .modal {
      padding: 24px;
    }
  }
  
  @media (max-width: 480px) {
    .garden-spot {
      width: 46px;
      height: 46px;
    }
    
    .activity-checks {
      grid-template-columns: 1fr;
    }
    
    .modal-actions {
      flex-direction: column;
    }
  }
</style>
</head>
<body>

<!-- PROGRESS PILL -->
<div class="progress-pill">
  <span>üåø</span>
  <span><strong id="filledCount">0</strong> / 30 days</span>
</div>

<!-- FLOATING LEGEND WITH STATS -->
<div class="floating-legend">
  <div class="legend-item">
    <span class="dot dot-recite"></span>
    <span>Recite</span>
    <strong id="statRecite">0</strong>
  </div>
  <div class="legend-item">
    <span class="dot dot-listen"></span>
    <span>Listen</span>
    <strong id="statListen">0</strong>
  </div>
  <div class="legend-item">
    <span class="dot dot-tafseer"></span>
    <span>Tafseer</span>
    <strong id="statTafseer">0</strong>
  </div>
  <div class="legend-item">
    <span class="dot dot-memorize"></span>
    <span>Memorize</span>
    <strong id="statMemorize">0</strong>
  </div>
</div>

<!-- KHATAM FLOAT -->
<div class="khatam-float">
  <div class="khatam-label">
    <span>Khatam Progress</span>
    <span id="khatamPct">0%</span>
  </div>
  <div class="khatam-bar-outer">
    <div class="khatam-bar-inner" id="khatamBar" style="width:0%"></div>
  </div>
  <div class="page-input-wrap">
    <input type="number" id="totalPagesInput" min="0" max="604" placeholder="0" oninput="updateKhatam()">
    <span>/ 604 pages</span>
  </div>
</div>

<!-- HEADER -->
<div class="header">
  <h1>Quran <span>Garden</span></h1>
  <div class="tagline">
    <span class="arabic">ÿ•ŸêŸÜŸéŸë ÿ£Ÿéÿ≠Ÿéÿ®ŸéŸë ÿßŸÑŸíÿ£ŸéÿπŸíŸÖŸéÿßŸÑŸê ÿ•ŸêŸÑŸéŸâ ÿßŸÑŸÑŸéŸëŸáŸê ÿ£ŸéÿØŸíŸàŸéŸÖŸèŸáŸéÿß ŸàŸéÿ•ŸêŸÜŸí ŸÇŸéŸÑŸéŸë</span>
    Allah loves small but consistent deeds
  </div>
</div>

<!-- GARDEN -->
<div class="garden-ground" id="gardenGround">
  <div class="garden-scatter" id="gardenScatter"></div>
</div>

<!-- MODAL -->
<div class="modal-overlay" id="modalOverlay" onclick="closeModalOnOverlay(event)">
  <div class="modal" id="modal">
    <button class="modal-close" onclick="closeModal()">‚úï</button>
    <div id="modalContent"></div>
  </div>
</div>

<script>
// ============================================================
// CONFIGURATION - BREVO API
// ============================================================
const BREVO_CONFIG = {
  apiKey: 'YOUR_BREVO_API_KEY_HERE', // Replace with your Brevo API key
  enabled: false, // Set to true when you have API key
  // Since GitHub repo is public, you should:
  // 1. Use GitHub Secrets for the API key
  // 2. Create a GitHub Action to deploy with the key
  // 3. Or use a serverless function (Vercel, Netlify) to hide the key
};

// Ibn Arabi Quotes for grass tooltips
const IBN_ARABI_QUOTES = [
  "Do not attach yourself to any particular creed exclusively, so that you may disbelieve all the rest; otherwise you will lose much good.",
  "My heart has become capable of every form: it is a pasture for gazelles and a monastery for Christian monks.",
  "Beware of confining yourself to a particular belief and denying all else, for much good would elude you.",
  "The ignorant one does not see the ignorance of his ignorance as he sees the ignorance of others.",
  "He who knows himself knows his Lord.",
  "The self is a sea boundless and measureless.",
  "Wheresoever you turn, there is the Face of God.",
  "The heart is the sanctuary of God; therefore, do not let anything but God reside in it.",
  "Knowledge is a light which God casts into the heart of whomsoever He wills.",
  "The spiritual journey does not consist of arriving at a new destination where a person gains what he did not have.",
  "Real generosity toward the future lies in giving all to the present.",
  "Most of those who think they are on the path are not really on the path.",
  "The Divine Reality is an ocean without shores.",
  "The eye through which I see God is the same eye through which God sees me.",
  "In the middle of every difficulty lies opportunity."
];

// ============================================================
// GARDEN ELEMENTS
// ============================================================
const GARDEN_ELEMENTS = [
  { id: 'daisy-white', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="60" stroke="#6b8e6b" stroke-width="3"/><ellipse cx="45" cy="90" rx="8" ry="5" fill="#9db4a0" transform="rotate(-30 45 90)"/>${Array.from({length:10},(_,i)=>{const a=i*36;const r=22;const cx=50+r*Math.sin(a*Math.PI/180);const cy=60+r*-Math.cos(a*Math.PI/180);return`<ellipse cx="${cx}" cy="${cy}" rx="9" ry="16" fill="#fdfbf7" stroke="#e6ddd0" stroke-width="1" transform="rotate(${a} ${cx} ${cy})"/>`}).join('')}<circle cx="50" cy="60" r="12" fill="#f0d78c" stroke="#e0c060" stroke-width="1.5"/></svg>`, name: 'Daisy' },
  { id: 'forgetmenot', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="55" stroke="#6b8e6b" stroke-width="3"/><ellipse cx="36" cy="90" rx="10" ry="6" fill="#9db4a0" transform="rotate(-40 36 90)"/>${[0,72,144,216,288].map(a=>{const r=16;const cx=50+r*Math.sin(a*Math.PI/180);const cy=55+r*-Math.cos(a*Math.PI/180);return`<ellipse cx="${cx}" cy="${cy}" rx="8" ry="12" fill="#a8c8dc" transform="rotate(${a} ${cx} ${cy})"/>`}).join('')}<circle cx="50" cy="55" r="7" fill="#fdfbf7"/><circle cx="50" cy="55" r="4" fill="#f0d78c"/></svg>`, name: 'Forget-me-not' },
  { id: 'carnation', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="55" stroke="#6b8e6b" stroke-width="3"/><ellipse cx="40" cy="88" rx="9" ry="5" fill="#9db4a0" transform="rotate(-35 40 88)"/>${Array.from({length:12},(_,i)=>{const a=i*30;const r=18;const cx=50+r*Math.sin(a*Math.PI/180);const cy=52+r*-Math.cos(a*Math.PI/180);return`<ellipse cx="${cx}" cy="${cy}" rx="10" ry="14" fill="#e8b4b8" stroke="#d4846c" stroke-width="0.5" transform="rotate(${a} ${cx} ${cy})"/>`}).join('')}<circle cx="50" cy="52" r="6" fill="#c06080"/></svg>`, name: 'Carnation' },
  { id: 'poppy', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="55" stroke="#6b8e6b" stroke-width="3"/><ellipse cx="38" cy="85" rx="10" ry="5.5" fill="#9db4a0" transform="rotate(-40 38 85)"/>${[0,90,180,270].map(a=>{const r=20;const cx=50+r*Math.sin(a*Math.PI/180);const cy=52+r*-Math.cos(a*Math.PI/180);return`<ellipse cx="${cx}" cy="${cy}" rx="16" ry="20" fill="#d4846c" stroke="#c06040" stroke-width="1" transform="rotate(${a} ${cx} ${cy})"/>`}).join('')}<circle cx="50" cy="52" r="10" fill="#3a3228"/></svg>`, name: 'Poppy' },
  { id: 'lavender', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="30" stroke="#6b8e6b" stroke-width="3"/><ellipse cx="40" cy="95" rx="9" ry="5" fill="#9db4a0" transform="rotate(-35 40 95)"/>${Array.from({length:8},(_,i)=>{const y=30+i*11;const side=i%2===0?-1:1;return`<ellipse cx="${50+side*7}" cy="${y}" rx="5" ry="8" fill="#c4b5d4" stroke="#a090c0" stroke-width="0.5" transform="rotate(${side*20} ${50+side*7} ${y})"/>`}).join('')}<ellipse cx="50" cy="28" rx="5" ry="9" fill="#c4b5d4"/></svg>`, name: 'Lavender' },
  { id: 'sunflower', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="58" stroke="#6b8e6b" stroke-width="3.5"/><ellipse cx="38" cy="90" rx="11" ry="6" fill="#9db4a0" transform="rotate(-35 38 90)"/>${Array.from({length:14},(_,i)=>{const a=i*25.7;const r=22;const cx=50+r*Math.sin(a*Math.PI/180);const cy=55+r*-Math.cos(a*Math.PI/180);return`<ellipse cx="${cx}" cy="${cy}" rx="8" ry="14" fill="#f0d78c" stroke="#e0c060" stroke-width="0.5" transform="rotate(${a} ${cx} ${cy})"/>`}).join('')}<circle cx="50" cy="55" r="14" fill="#7a4820"/></svg>`, name: 'Sunflower' },
  { id: 'tulip', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="60" stroke="#6b8e6b" stroke-width="3"/><ellipse cx="38" cy="88" rx="11" ry="6" fill="#9db4a0" transform="rotate(-40 38 88)"/><path d="M38 60 Q30 45 32 32 Q40 22 50 22 Q60 22 68 32 Q70 45 62 60 Z" fill="#e8b4b8" stroke="#d4846c" stroke-width="1.5"/></svg>`, name: 'Tulip' },
  { id: 'butterfly-blue', svg: `<svg viewBox="0 0 100 100"><ellipse cx="35" cy="38" rx="24" ry="18" fill="#a8c8dc" stroke="#6898c8" stroke-width="1.5" transform="rotate(-20 35 38)"/><ellipse cx="65" cy="38" rx="24" ry="18" fill="#a8c8dc" stroke="#6898c8" stroke-width="1.5" transform="rotate(20 65 38)"/><ellipse cx="33" cy="60" rx="16" ry="12" fill="#b8d0e8" stroke="#6898c8" stroke-width="1.5" transform="rotate(15 33 60)"/><ellipse cx="67" cy="60" rx="16" ry="12" fill="#b8d0e8" stroke="#6898c8" stroke-width="1.5" transform="rotate(-15 67 60)"/><ellipse cx="50" cy="50" rx="4" ry="22" fill="#4a453e"/><line x1="45" y1="30" x2="35" y2="18" stroke="#4a453e" stroke-width="1.5"/><line x1="55" y1="30" x2="65" y2="18" stroke="#4a453e" stroke-width="1.5"/><circle cx="35" cy="18" r="2" fill="#4a453e"/><circle cx="65" cy="18" r="2" fill="#4a453e"/></svg>`, name: 'Blue Butterfly' },
  { id: 'butterfly-pink', svg: `<svg viewBox="0 0 100 100"><ellipse cx="33" cy="38" rx="24" ry="17" fill="#e8b4b8" stroke="#d4846c" stroke-width="1.5" transform="rotate(-22 33 38)"/><ellipse cx="67" cy="38" rx="24" ry="17" fill="#e8b4b8" stroke="#d4846c" stroke-width="1.5" transform="rotate(22 67 38)"/><ellipse cx="32" cy="60" rx="15" ry="11" fill="#f8d0d8" stroke="#d4846c" stroke-width="1.5" transform="rotate(18 32 60)"/><ellipse cx="68" cy="60" rx="15" ry="11" fill="#f8d0d8" stroke="#d4846c" stroke-width="1.5" transform="rotate(-18 68 60)"/><ellipse cx="50" cy="50" rx="4" ry="22" fill="#4a453e"/><line x1="45" y1="30" x2="34" y2="18" stroke="#4a453e" stroke-width="1.5"/><line x1="55" y1="30" x2="66" y2="18" stroke="#4a453e" stroke-width="1.5"/><circle cx="34" cy="18" r="2" fill="#4a453e"/><circle cx="66" cy="18" r="2" fill="#4a453e"/></svg>`, name: 'Pink Butterfly' },
  { id: 'ladybug', svg: `<svg viewBox="0 0 100 100"><ellipse cx="50" cy="62" rx="28" ry="24" fill="#d4846c" stroke="#c06040" stroke-width="2"/><ellipse cx="50" cy="38" rx="16" ry="13" fill="#3a3228" stroke="#2a2018" stroke-width="1.5"/><circle cx="42" cy="35" r="4" fill="#fdfbf7"/><circle cx="58" cy="35" r="4" fill="#fdfbf7"/><line x1="50" y1="38" x2="50" y2="86" stroke="#c06040" stroke-width="2"/><circle cx="36" cy="55" r="6" fill="#3a3228"/><circle cx="64" cy="55" r="6" fill="#3a3228"/></svg>`, name: 'Ladybug' },
  { id: 'rose', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="55" stroke="#6b8e6b" stroke-width="3"/><ellipse cx="42" cy="85" rx="9" ry="5" fill="#9db4a0" transform="rotate(-30 42 85)"/>${[0,72,144,216,288].map(a=>{const r=18;const cx=50+r*Math.sin(a*Math.PI/180);const cy=52+r*-Math.cos(a*Math.PI/180);return`<ellipse cx="${cx}" cy="${cy}" rx="13" ry="18" fill="#e8b4b8" stroke="#d4846c" stroke-width="0.8" transform="rotate(${a} ${cx} ${cy})"/>`}).join('')}<circle cx="50" cy="52" r="10" fill="#f0d78c"/></svg>`, name: 'Wild Rose' },
  { id: 'lily', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="55" stroke="#6b8e6b" stroke-width="3"/><ellipse cx="38" cy="90" rx="10" ry="5.5" fill="#9db4a0" transform="rotate(-35 38 90)"/>${[[-20,0],[-12,-16],[0,-22],[12,-16],[20,0]].map(([dx,dy],i)=>`<ellipse cx="${50+dx}" cy="${60+dy}" rx="8" ry="18" fill="#f5e0c0" stroke="#e8c0a0" stroke-width="1" transform="rotate(${-90+i*30} ${50+dx} ${60+dy})"/>`).join('')}<circle cx="50" cy="55" r="6" fill="#f5b040"/></svg>`, name: 'Lily' },
  { id: 'cosmos', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="55" stroke="#6b8e6b" stroke-width="2.5"/><ellipse cx="38" cy="90" rx="9" ry="5" fill="#9db4a0" transform="rotate(-40 38 90)"/>${[0,51.4,102.8,154.2,205.6,257,308.4].map(a=>{const r=20;const cx=50+r*Math.sin(a*Math.PI/180);const cy=52+r*-Math.cos(a*Math.PI/180);return`<ellipse cx="${cx}" cy="${cy}" rx="9" ry="18" fill="#e8b4c8" stroke="#d4849c" stroke-width="0.8" transform="rotate(${a} ${cx} ${cy})"/>`}).join('')}<circle cx="50" cy="52" r="9" fill="#f0d78c"/></svg>`, name: 'Cosmos' },
  { id: 'hydrangea', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="68" stroke="#6b8e6b" stroke-width="3"/><ellipse cx="40" cy="92" rx="9" ry="5" fill="#9db4a0" transform="rotate(-35 40 92)"/>${[[-12,-12],[0,-18],[12,-12],[18,0],[12,12],[0,18],[-12,12],[-18,0]].map(([dx,dy])=>`<g transform="translate(${50+dx},${60+dy})">${[0,90,180,270].map(a=>`<ellipse cx="${6*Math.sin(a*Math.PI/180)}" cy="${-6*Math.cos(a*Math.PI/180)}" rx="5" ry="7" fill="#c0b8e0" stroke="#a098c8" stroke-width="0.5" transform="rotate(${a})"/>`).join('')}<circle cx="0" cy="0" r="3" fill="#fdfbf7"/></g>`).join('')}</svg>`, name: 'Hydrangea' },
  { id: 'peony', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="62" stroke="#6b8e6b" stroke-width="3"/><ellipse cx="38" cy="90" rx="10" ry="5.5" fill="#9db4a0" transform="rotate(-38 38 90)"/>${Array.from({length:6},(_,i)=>{const a=i*60;const r=24;const cx=50+r*Math.sin(a*Math.PI/180);const cy=58+r*-Math.cos(a*Math.PI/180);return`<ellipse cx="${cx}" cy="${cy}" rx="16" ry="22" fill="#f0c8d8" stroke="#d090b0" stroke-width="0.8" transform="rotate(${a} ${cx} ${cy})"/>`}).join('')}<circle cx="50" cy="58" r="8" fill="#c04070"/></svg>`, name: 'Peony' },
  { id: 'clover', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="68" stroke="#6b8e6b" stroke-width="2.5"/><circle cx="50" cy="55" r="14" fill="#b8d4a8" stroke="#78b478" stroke-width="1.5"/><circle cx="36" cy="55" r="14" fill="#b8d4a8" stroke="#78b478" stroke-width="1.5"/><circle cx="50" cy="41" r="14" fill="#b8d4a8" stroke="#78b478" stroke-width="1.5"/><circle cx="64" cy="55" r="14" fill="#b8d4a8" stroke="#78b478" stroke-width="1.5"/><circle cx="50" cy="55" r="6" fill="#78b478"/></svg>`, name: 'Clover' },
  { id: 'bluebell', svg: `<svg viewBox="0 0 100 120"><path d="M50 120 Q50 70 50 40" stroke="#6b8e6b" stroke-width="3" fill="none"/><ellipse cx="40" cy="88" rx="9" ry="5" fill="#9db4a0" transform="rotate(-35 40 88)"/>${[[-15,55],[-6,45],[6,38],[16,48]].map(([dx,y])=>`<path d="M${50+dx} ${y} Q${50+dx-4} ${y+18} ${50+dx} ${y+22} Q${50+dx+4} ${y+18} ${50+dx} ${y}" fill="#7898d0" stroke="#5878b0" stroke-width="0.5"/><line x1="${50+dx}" y1="${y}" x2="${50+dx+dx*0.6}" y2="${y-10}" stroke="#6b8e6b" stroke-width="1.5"/>`).join('')}</svg>`, name: 'Bluebell' },

  { id: 'chamomile', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="65" stroke="#6b8e6b" stroke-width="3"/><line x1="50" y1="85" x2="35" y2="70" stroke="#6b8e6b" stroke-width="2"/>${[0,45,90,135,180,225,270,315].map(a=>{const r=12;const cx=50+r*Math.sin(a*Math.PI/180);const cy=65+r*-Math.cos(a*Math.PI/180);return`<ellipse cx="${cx}" cy="${cy}" rx="5" ry="11" fill="#fdfbf7" stroke="#e6ddd0" stroke-width="0.8" transform="rotate(${a} ${cx} ${cy})"/>`}).join('')}<circle cx="50" cy="65" r="8" fill="#f0d78c"/></svg>`, name: 'Chamomile' },

  { id: 'honeybee', svg: `<svg viewBox="0 0 100 100"><ellipse cx="50" cy="58" rx="20" ry="14" fill="#f5c030" stroke="#d0a020" stroke-width="1.5"/><rect x="36" y="52" width="28" height="5" rx="2" fill="#4a453e"/><rect x="36" y="61" width="28" height="5" rx="2" fill="#4a453e"/><ellipse cx="50" cy="42" rx="12" ry="10" fill="#f5c030" stroke="#d0a020" stroke-width="1.5"/><circle cx="44" cy="40" r="3" fill="#4a453e"/><circle cx="56" cy="40" r="3" fill="#4a453e"/><ellipse cx="32" cy="50" rx="15" ry="7" fill="rgba(168,196,224,0.7)" stroke="rgba(100,150,200,0.5)" stroke-width="1" transform="rotate(-30 32 50)"/><ellipse cx="68" cy="50" rx="15" ry="7" fill="rgba(168,196,224,0.7)" stroke="rgba(100,150,200,0.5)" stroke-width="1" transform="rotate(30 68 50)"/></svg>`, name: 'Honeybee' },

  { id: 'marigold', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="58" stroke="#6b8e6b" stroke-width="3"/><ellipse cx="40" cy="88" rx="10" ry="5.5" fill="#9db4a0" transform="rotate(-35 40 88)"/>${Array.from({length:16},(_,i)=>{const a=i*22.5;const r=18;const cx=50+r*Math.sin(a*Math.PI/180);const cy=55+r*-Math.cos(a*Math.PI/180);return`<ellipse cx="${cx}" cy="${cy}" rx="7" ry="12" fill="#f0a030" stroke="#e08020" stroke-width="0.5" transform="rotate(${a} ${cx} ${cy})"/>`}).join('')}<circle cx="50" cy="55" r="8" fill="#e08020"/></svg>`, name: 'Marigold' },

  { id: 'cornflower', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="58" stroke="#6b8e6b" stroke-width="2.5"/><ellipse cx="38" cy="90" rx="9" ry="5" fill="#9db4a0" transform="rotate(-35 38 90)"/>${[0,60,120,180,240,300].map(a=>{const r=20;const cx=50+r*Math.sin(a*Math.PI/180);const cy=55+r*-Math.cos(a*Math.PI/180);return`<path d="M${cx} ${cy-14} Q${cx+8} ${cy} ${cx} ${cy+14} Q${cx-8} ${cy} ${cx} ${cy-14}" fill="#5878d0" stroke="#3a58b8" stroke-width="0.8" transform="rotate(${a} ${cx} ${cy})"/>`}).join('')}<circle cx="50" cy="55" r="8" fill="#3a58b8"/></svg>`, name: 'Cornflower' },

  { id: 'dragonfly', svg: `<svg viewBox="0 0 100 100"><ellipse cx="50" cy="50" rx="5" ry="28" fill="#6b8e6b"/><ellipse cx="50" cy="35" rx="8" ry="10" fill="#3a6b3a"/><ellipse cx="30" cy="40" rx="22" ry="10" fill="rgba(168,220,200,0.7)" stroke="rgba(80,160,120,0.6)" stroke-width="1.2" transform="rotate(-10 30 40)"/><ellipse cx="70" cy="40" rx="22" ry="10" fill="rgba(168,220,200,0.7)" stroke="rgba(80,160,120,0.6)" stroke-width="1.2" transform="rotate(10 70 40)"/><ellipse cx="28" cy="55" rx="16" ry="7" fill="rgba(168,220,200,0.5)" stroke="rgba(80,160,120,0.5)" stroke-width="1" transform="rotate(-15 28 55)"/><ellipse cx="72" cy="55" rx="16" ry="7" fill="rgba(168,220,200,0.5)" stroke="rgba(80,160,120,0.5)" stroke-width="1" transform="rotate(15 72 55)"/><circle cx="46" cy="30" r="3.5" fill="#fdfbf7"/><circle cx="54" cy="30" r="3.5" fill="#fdfbf7"/></svg>`, name: 'Dragonfly' },

  { id: 'snail', svg: `<svg viewBox="0 0 100 100"><ellipse cx="58" cy="65" rx="28" ry="14" fill="#c0a880" stroke="#a08860" stroke-width="1.5"/><path d="M42 60 Q32 55 28 45 Q24 32 34 26 Q44 20 52 28 Q60 36 54 46 Q48 54 40 52 Q32 50 32 42 Q32 34 40 32" stroke="#8a6840" stroke-width="2" fill="none" stroke-linecap="round"/><ellipse cx="42" cy="60" rx="14" ry="10" fill="#d0b890"/><line x1="28" y1="55" x2="18" y2="45" stroke="#c0a880" stroke-width="2"/><line x1="30" y1="52" x2="22" y2="40" stroke="#c0a880" stroke-width="2"/><circle cx="18" cy="44" r="3" fill="#5a3228"/><circle cx="22" cy="40" r="3" fill="#5a3228"/></svg>`, name: 'Snail' },

  { id: 'fern', svg: `<svg viewBox="0 0 100 120"><path d="M50 115 Q50 60 50 20" stroke="#6b8e6b" stroke-width="2.5" fill="none"/>${Array.from({length:10},(_,i)=>{const y=25+i*9;const side=i%2===0?-1:1;const size=Math.min(12+i*1.5,20);return`<ellipse cx="${50+side*size*0.55}" cy="${y-size*0.1}" rx="${size*0.4}" ry="${size*0.25}" fill="#9db4a0" transform="rotate(${side*20} ${50+side*size*0.55} ${y-size*0.1})"/>`}).join('')}</svg>`, name: 'Fern' },

  { id: 'crocus', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="65" stroke="#6b8e6b" stroke-width="2.5"/>${[[-12,0],[0,-5],[12,0]].map(([dx,dy])=>`<path d="M${50+dx} 65 Q${50+dx-5} 50 ${50+dx+dx*0.3} 35 Q${50+dx+dx*0.3+5} 50 ${50+dx} 65" fill="#c4b5d4" stroke="#9880b8" stroke-width="1"/>`).join('')}<line x1="50" y1="50" x2="50" y2="38" stroke="#f0d78c" stroke-width="2"/><circle cx="50" cy="37" r="3" fill="#f0a020"/></svg>`, name: 'Crocus' },

  { id: 'caterpillar', svg: `<svg viewBox="0 0 120 80">${[0,1,2,3,4,5].map(i=>`<circle cx="${20+i*16}" cy="52" r="12" fill="${['#b8d4c8','#e8b4b8','#f0d78c','#c4b5d4','#a8c8dc','#e8b4b8'][i]}" stroke="rgba(0,0,0,0.1)" stroke-width="1"/>`).join('')}<circle cx="104" cy="52" r="14" fill="#b8d4c8" stroke="rgba(0,0,0,0.1)" stroke-width="1"/><circle cx="97" cy="46" r="4" fill="#fdfbf7"/><circle cx="97" cy="46" r="2.5" fill="#4a453e"/><path d="M96 58 Q104 62 112 58" stroke="#6b8e6b" stroke-width="1.5" fill="none" stroke-linecap="round"/></svg>`, name: 'Caterpillar' },

  { id: 'mushroom', svg: `<svg viewBox="0 0 100 110"><rect x="42" y="75" width="16" height="30" rx="6" fill="#e6ddd0" stroke="#c0a880" stroke-width="1.5"/><path d="M25 70 Q22 50 30 38 Q40 22 50 20 Q60 22 70 38 Q78 50 75 70 Z" fill="#d4846c" stroke="#c06040" stroke-width="2"/><circle cx="42" cy="42" r="7" fill="#fdfbf7" opacity="0.9"/><circle cx="62" cy="38" r="5" fill="#fdfbf7" opacity="0.9"/><circle cx="52" cy="55" r="6" fill="#fdfbf7" opacity="0.9"/></svg>`, name: 'Mushroom' },

  { id: 'wisteria', svg: `<svg viewBox="0 0 100 120"><path d="M50 10 Q60 20 55 35 Q52 45 50 55 Q48 65 50 80" stroke="#6b8e6b" stroke-width="2.5" fill="none"/>${[[40,40,8],[55,35,7],[44,55,9],[52,60,8]].map(([cx,cy,n])=>Array.from({length:n},(_,i)=>{const a=i*(360/n);const r=5;const bx=cx+r*Math.sin(a*Math.PI/180);const by=cy+r*Math.cos(a*Math.PI/180);return`<ellipse cx="${bx}" cy="${by}" rx="4" ry="6" fill="#c0b8e0" stroke="#a098c8" stroke-width="0.5" transform="rotate(${a} ${bx} ${by})"/>`}).join('')).join('')}</svg>`, name: 'Wisteria' },

  { id: 'dandelion', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="55" stroke="#6b8e6b" stroke-width="2.5"/><ellipse cx="40" cy="88" rx="9" ry="5" fill="#9db4a0" transform="rotate(-35 40 88)"/>${Array.from({length:20},(_,i)=>{const a=i*18;const r=22;const cx=50+r*Math.sin(a*Math.PI/180);const cy=55+r*-Math.cos(a*Math.PI/180);return`<line x1="50" y1="55" x2="${cx}" y2="${cy}" stroke="#d8d0c0" stroke-width="1.2"/><circle cx="${cx}" cy="${cy}" r="3.5" fill="#f8f5e8" stroke="#e0d8c0" stroke-width="0.5"/>`}).join('')}<circle cx="50" cy="55" r="6" fill="#e0d870"/></svg>`, name: 'Dandelion Puff' },

  { id: 'magnolia', svg: `<svg viewBox="0 0 100 120"><line x1="50" y1="120" x2="50" y2="60" stroke="#5a3a28" stroke-width="3.5"/><ellipse cx="40" cy="88" rx="10" ry="5.5" fill="#6a8a60" transform="rotate(-35 40 88)"/>${[[-5,0],[-18,-8],[18,-8],[-10,-20],[10,-20],[0,-25]].map(([dx,dy])=>`<path d="M50 62 Q${50+dx} ${62+dy-10} ${50+dx*1.2} ${62+dy-22} Q${50} ${62+dy-30} ${50-dx*1.2} ${62+dy-22} Q${50-dx} ${62+dy-10} 50 62" fill="#f8e0e8" stroke="#e8c0c8" stroke-width="1"/>`).join('')}<circle cx="50" cy="58" r="5" fill="#f0d78c"/></svg>`, name: 'Magnolia' },

  { id: 'moth', svg: `<svg viewBox="0 0 100 100"><ellipse cx="50" cy="50" rx="4" ry="24" fill="#5a4a38"/><ellipse cx="50" cy="36" rx="6" ry="8" fill="#3a2a20"/><ellipse cx="28" cy="42" rx="22" ry="13" fill="#e8d8a0" stroke="#c0a860" stroke-width="1.2" transform="rotate(-15 28 42)"/><ellipse cx="72" cy="42" rx="22" ry="13" fill="#e8d8a0" stroke="#c0a860" stroke-width="1.2" transform="rotate(15 72 42)"/><ellipse cx="30" cy="56" rx="14" ry="9" fill="#d4c080" stroke="#c0a860" stroke-width="1" transform="rotate(10 30 56)"/><ellipse cx="70" cy="56" rx="14" ry="9" fill="#d4c080" stroke="#c0a860" stroke-width="1" transform="rotate(-10 70 56)"/><circle cx="44" cy="32" r="3" fill="#fdfbf7"/><circle cx="56" cy="32" r="3" fill="#fdfbf7"/></svg>`, name: 'Moth' },
];

// Grass SVG
const GRASS_SVG = `<svg viewBox="0 0 100 120" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M50 110 Q42 80 38 50 Q36 30 42 15" stroke="#6b8e6b" stroke-width="2" stroke-linecap="round" fill="none"/>
  <path d="M50 110 Q50 75 50 45 Q50 25 50 10" stroke="#7aba62" stroke-width="2" stroke-linecap="round" fill="none"/>
  <path d="M50 110 Q58 80 62 50 Q64 30 58 15" stroke="#6b8e6b" stroke-width="2" stroke-linecap="round" fill="none"/>
</svg>`;

// Cloud SVG
const CLOUD_SVG = `<svg width="120" height="60" viewBox="0 0 120 60" fill="none" xmlns="http://www.w3.org/2000/svg">
  <ellipse cx="30" cy="35" rx="20" ry="15" fill="#e6ddd0"/>
  <ellipse cx="55" cy="30" rx="25" ry="18" fill="#e6ddd0"/>
  <ellipse cx="80" cy="35" rx="22" ry="16" fill="#e6ddd0"/>
  <ellipse cx="95" cy="40" rx="18" ry="13" fill="#e6ddd0"/>
  <rect x="15" y="35" width="90" height="20" fill="#e6ddd0"/>
</svg>`;

// Organic scattered positions
const SCATTER_POSITIONS = [
  {x: 15, y: 20}, {x: 35, y: 12}, {x: 55, y: 18}, {x: 75, y: 15}, {x: 88, y: 25},
  {x: 8, y: 45}, {x: 28, y: 38}, {x: 48, y: 42}, {x: 68, y: 35}, {x: 85, y: 48},
  {x: 20, y: 65}, {x: 40, y: 58}, {x: 60, y: 62}, {x: 80, y: 55}, {x: 92, y: 70},
  {x: 12, y: 82}, {x: 32, y: 78}, {x: 52, y: 85}, {x: 72, y: 75}, {x: 88, y: 88},
  {x: 25, y: 95}, {x: 45, y: 92}, {x: 65, y: 98}, {x: 82, y: 95}, {x: 5, y: 95},
  {x: 95, y: 40}, {x: 50, y: 5}, {x: 5, y: 60}, {x: 95, y: 82}, {x: 38, y: 28}
];

const TOTAL_DAYS = 30;
let entries = JSON.parse(localStorage.getItem('quranGarden') || '{}');
let totalPages = parseInt(localStorage.getItem('quranPages') || '0');

// ============================================================
// BREVO EMAIL INTEGRATION
// ============================================================
async function sendBrevoEmail(recipientEmail, day, entry) {
  if (!BREVO_CONFIG.enabled || !BREVO_CONFIG.apiKey || BREVO_CONFIG.apiKey === 'YOUR_BREVO_API_KEY_HERE') {
    console.log('Brevo email disabled or API key not configured');
    return;
  }

  const activities = [];
  if (entry.activities.recite) activities.push('üìñ Reciting');
  if (entry.activities.listen) activities.push('üéß Listening');
  if (entry.activities.tafseer) activities.push('üìö Tafseer');
  if (entry.activities.memorize) activities.push('üíé Memorizing');

  const emailData = {
    sender: {
      name: "Quran Garden",
      email: "hai@shafiranoh.com" // Replace with your verified sender email
    },
    to: [
      {
        email: recipientEmail,
        name: recipientEmail.split('@')[0]
      }
    ],
    subject: `üå∏ Day ${day} Planted in Your Quran Garden`,
    htmlContent: `
      <!DOCTYPE html>
      <html>
      <head>
        <style>
          body { font-family: 'Inter', sans-serif; background: #faf8f3; padding: 20px; }
          .container { max-width: 600px; margin: 0 auto; background: white; border-radius: 20px; padding: 40px; }
          .header { text-align: center; margin-bottom: 30px; }
          .header h1 { color: #6b8e6b; font-family: 'Cormorant Garamond', serif; font-size: 32px; margin-bottom: 10px; }
          .day-badge { background: #e8b4b8; color: white; padding: 8px 16px; border-radius: 20px; display: inline-block; font-weight: 600; }
          .activities { margin: 20px 0; padding: 20px; background: #faf8f3; border-radius: 12px; }
          .activity-item { margin: 8px 0; font-size: 14px; }
          .notes { margin: 20px 0; padding: 20px; background: rgba(157,180,160,0.1); border-radius: 12px; font-style: italic; }
          .footer { text-align: center; margin-top: 30px; color: #8a8075; font-size: 12px; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1>üåø Quran Garden</h1>
            <span class="day-badge">Day ${day}</span>
            <p style="margin-top: 10px; color: #8a8075;">A seed has been planted in your garden!</p>
          </div>
          
          <div class="activities">
            <h3 style="color: #6b8e6b; margin-bottom: 10px;">Activities</h3>
            ${activities.map(a => `<div class="activity-item">${a}</div>`).join('')}
            ${entry.todayPages ? `<div class="activity-item">üìú ${entry.todayPages} pages read</div>` : ''}
          </div>
          
          ${entry.notes ? `
            <div class="notes">
              <h3 style="color: #6b8e6b; margin-bottom: 10px;">Reflection</h3>
              <p>"${entry.notes}"</p>
            </div>
          ` : ''}
          
          <div class="footer">
            <p style="font-style: italic; margin-bottom: 10px;">ÿ•ŸêŸÜŸéŸë ÿ£Ÿéÿ≠Ÿéÿ®ŸéŸë ÿßŸÑŸíÿ£ŸéÿπŸíŸÖŸéÿßŸÑŸê ÿ•ŸêŸÑŸéŸâ ÿßŸÑŸÑŸéŸëŸáŸê ÿ£ŸéÿØŸíŸàŸéŸÖŸèŸáŸéÿß ŸàŸéÿ•ŸêŸÜŸí ŸÇŸéŸÑŸéŸë</p>
            <p>Allah loves small but consistent deeds</p>
            <p style="margin-top: 20px;">Visit your <a href="https://yourwebsite.com/quran-garden" style="color: #6b8e6b;">Quran Garden</a></p>
          </div>
        </div>
      </body>
      </html>
    `
  };

  try {
    const response = await fetch('https://api.brevo.com/v3/smtp/email', {
      method: 'POST',
      headers: {
        'accept': 'application/json',
        'api-key': BREVO_CONFIG.apiKey,
        'content-type': 'application/json'
      },
      body: JSON.stringify(emailData)
    });

    if (!response.ok) {
      throw new Error(`Brevo API error: ${response.statusText}`);
    }

    console.log('Email sent successfully via Brevo');
    return await response.json();
  } catch (error) {
    console.error('Error sending email via Brevo:', error);
    throw error;
  }
}

// ============================================================
// RENDER GARDEN
// ============================================================
function renderGarden() {
  const ground = document.getElementById('gardenGround');
  const scatter = document.getElementById('gardenScatter');
  scatter.innerHTML = '';
  
  // Add clouds
  const cloudPositions = [
    { x: '10%', y: '50px', delay: '0s' },
    { x: '70%', y: '80px', delay: '15s' },
    { x: '40%', y: '40px', delay: '30s' }
  ];
  
  cloudPositions.forEach(pos => {
    const existingCloud = ground.querySelector(`.cloud[style*="${pos.x}"]`);
    if (!existingCloud) {
      const cloud = document.createElement('div');
      cloud.className = 'cloud';
      cloud.style.left = pos.x;
      cloud.style.top = pos.y;
      cloud.style.animationDelay = pos.delay;
      cloud.innerHTML = CLOUD_SVG;
      ground.insertBefore(cloud, scatter);
    }
  });
  
  // Add decorative grass with Ibn Arabi quotes
  const grassCount = 20;
  for (let i = 0; i < grassCount; i++) {
    const existingGrass = scatter.querySelector(`.decorative-grass[data-index="${i}"]`);
    if (!existingGrass) {
      const grass = document.createElement('div');
      grass.className = 'decorative-grass';
      grass.setAttribute('data-index', i);
      grass.style.left = (Math.random() * 95) + '%';
      grass.style.top = (Math.random() * 95) + '%';
      const quote = IBN_ARABI_QUOTES[i % IBN_ARABI_QUOTES.length];
      grass.innerHTML = `
        ${GRASS_SVG}
        <div class="grass-tooltip">${quote}</div>
      `;
      scatter.appendChild(grass);
    }
  }
  
  let filledCount = 0;

  for(let day = 1; day <= TOTAL_DAYS; day++) {
    const entry = entries[day];
    const pos = SCATTER_POSITIONS[day-1];
    const spot = document.createElement('div');
    
    spot.className = 'garden-spot ' + (entry ? 'filled' : 'empty');
    spot.style.left = pos.x + '%';
    spot.style.top = pos.y + '%';
    spot.style.setProperty('--spot-index', day);

    if(entry) {
      filledCount++;
      const el = GARDEN_ELEMENTS.find(e => e.id === entry.elementId) || GARDEN_ELEMENTS[0];
      const dots = [
        entry.activities.recite ? '<span class="dot-mini" style="background:var(--sage)"></span>' : '',
        entry.activities.listen ? '<span class="dot-mini" style="background:var(--sky)"></span>' : '',
        entry.activities.tafseer ? '<span class="dot-mini" style="background:var(--lavender)"></span>' : '',
        entry.activities.memorize ? '<span class="dot-mini" style="background:var(--terracotta)"></span>' : '',
      ].join('');

      // Create excerpt for hover
      const excerpt = entry.notes ? entry.notes.substring(0, 80) + (entry.notes.length > 80 ? '...' : '') : '';
      const excerptHTML = excerpt ? `
        <div class="hover-excerpt">
          <span class="excerpt-day">Day ${day}</span>
          <div class="excerpt-text">${excerpt}</div>
        </div>
      ` : '';

      spot.innerHTML = `
        ${el.svg}
        <div class="day-label">Day ${day}</div>
        ${dots ? `<div class="activity-dots">${dots}</div>` : ''}
        ${excerptHTML}
      `;
      spot.onclick = () => openViewModal(day);
    } else {
      spot.innerHTML = `
        <div class="day-num">${day}</div>
        <div class="plus-icon">+</div>
      `;
      spot.onclick = () => openAddModal(day);
    }

    scatter.appendChild(spot);
  }

  document.getElementById('filledCount').textContent = filledCount;
  updateStats();
}

function updateStats() {
  let recite=0, listen=0, tafseer=0, memorize=0;
  for(const d in entries) {
    const e = entries[d];
    if(e.activities.recite) recite++;
    if(e.activities.listen) listen++;
    if(e.activities.tafseer) tafseer++;
    if(e.activities.memorize) memorize++;
  }
  
  document.getElementById('statRecite').textContent = recite;
  document.getElementById('statListen').textContent = listen;
  document.getElementById('statTafseer').textContent = tafseer;
  document.getElementById('statMemorize').textContent = memorize;
}

function updateKhatam() {
  const input = document.getElementById('totalPagesInput');
  totalPages = Math.min(604, Math.max(0, parseInt(input.value) || 0));
  localStorage.setItem('quranPages', totalPages);
  const pct = Math.round((totalPages / 604) * 100);
  document.getElementById('khatamBar').style.width = pct + '%';
  document.getElementById('khatamPct').textContent = pct + '%';
}

let currentSelectedElement = null;
let currentActivities = { recite: false, listen: false, tafseer: false, memorize: false };

function openAddModal(day) {
  currentSelectedElement = null;
  currentActivities = { recite: false, listen: false, tafseer: false, memorize: false };

  const content = document.getElementById('modalContent');
  content.innerHTML = `
    <div class="modal-flower" id="previewFlower">
      ${GARDEN_ELEMENTS[0].svg}
    </div>
    <h2>Day ${day}</h2>
    <div class="modal-date">What seeds did you plant today?</div>

    <div class="form-group">
      <label>Activities</label>
      <div class="activity-checks">
        <div class="activity-check recite" id="check-recite" onclick="toggleActivity('recite')">
          <input type="checkbox" id="act-recite">
          <span class="check-icon">üìñ</span>
          <span class="check-label">Reciting</span>
        </div>
        <div class="activity-check listen" id="check-listen" onclick="toggleActivity('listen')">
          <input type="checkbox" id="act-listen">
          <span class="check-icon">üéß</span>
          <span class="check-label">Listening</span>
        </div>
        <div class="activity-check tafseer" id="check-tafseer" onclick="toggleActivity('tafseer')">
          <input type="checkbox" id="act-tafseer">
          <span class="check-icon">üìö</span>
          <span class="check-label">Tafseer</span>
        </div>
        <div class="activity-check memorize" id="check-memorize" onclick="toggleActivity('memorize')">
          <input type="checkbox" id="act-memorize">
          <span class="check-icon">üíé</span>
          <span class="check-label">Memorize</span>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label>Pages today</label>
      <input type="number" id="todayPages" min="0" max="604" placeholder="0">
    </div>

    <div class="form-group">
      <label>Reflection</label>
      <textarea id="entryNotes" rows="3" placeholder="What touched your heart today?"></textarea>
    </div>

    <div class="form-group">
      <label>Share with (email)</label>
      <input type="email" id="entryEmail" placeholder="friend@email.com">
    </div>

    <div class="form-group">
      <span class="flower-picker-label">Choose a garden friend</span>
      <div class="flower-picker" id="flowerPicker"></div>
    </div>

    <div class="modal-actions">
      <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
      <button class="btn btn-primary" onclick="saveEntry(${day})">Plant üå±</button>
    </div>
  `;

  const picker = document.getElementById('flowerPicker');
  GARDEN_ELEMENTS.forEach((el, i) => {
    const opt = document.createElement('div');
    opt.className = 'flower-option' + (i === 0 ? ' selected' : '');
    opt.innerHTML = el.svg;
    opt.title = el.name;
    opt.onclick = () => selectFlower(el.id, opt);
    picker.appendChild(opt);
  });
  currentSelectedElement = GARDEN_ELEMENTS[0].id;

  openModal();
}

function selectFlower(id, el) {
  currentSelectedElement = id;
  document.querySelectorAll('.flower-option').forEach(o => o.classList.remove('selected'));
  el.classList.add('selected');
  const found = GARDEN_ELEMENTS.find(e => e.id === id);
  if(found) document.getElementById('previewFlower').innerHTML = found.svg;
}

function toggleActivity(type) {
  currentActivities[type] = !currentActivities[type];
  const el = document.getElementById('check-' + type);
  if(currentActivities[type]) el.classList.add('active');
  else el.classList.remove('active');
}

async function saveEntry(day) {
  const notes = document.getElementById('entryNotes').value.trim();
  const email = document.getElementById('entryEmail').value.trim();
  const todayPages = parseInt(document.getElementById('todayPages').value) || 0;

  if(!Object.values(currentActivities).some(v=>v) && !notes) {
    alert('Plant at least one seed of activity üå±');
    return;
  }

  entries[day] = {
    activities: {...currentActivities},
    notes,
    email,
    todayPages,
    elementId: currentSelectedElement || GARDEN_ELEMENTS[0].id,
    date: new Date().toLocaleDateString('en-MY', {day:'numeric',month:'long',year:'numeric'}),
  };

  localStorage.setItem('quranGarden', JSON.stringify(entries));
  
  // Send email notification via Brevo if email provided
  if(email) {
    try {
      await sendBrevoEmail(email, day, entries[day]);
      console.log('Notification sent to:', email);
    } catch (error) {
      console.error('Failed to send email notification:', error);
      // Don't block the user flow if email fails
    }
  }
  
  closeModal();
  renderGarden();
}

function openViewModal(day) {
  const entry = entries[day];
  if(!entry) return;
  const el = GARDEN_ELEMENTS.find(e => e.id === entry.elementId) || GARDEN_ELEMENTS[0];

  const actBadges = [
    entry.activities.recite ? `<span class="activity-badge" style="background:rgba(157,180,160,0.15);color:var(--moss)">üìñ Reciting</span>` : '',
    entry.activities.listen ? `<span class="activity-badge" style="background:rgba(168,200,220,0.2);color:#5a8aa0">üéß Listening</span>` : '',
    entry.activities.tafseer ? `<span class="activity-badge" style="background:rgba(196,181,212,0.2);color:#8a7aa8">üìö Tafseer</span>` : '',
    entry.activities.memorize ? `<span class="activity-badge" style="background:rgba(212,132,108,0.15);color:var(--terracotta)">üíé Memorize</span>` : '',
  ].filter(Boolean).join('');

  document.getElementById('modalContent').innerHTML = `
    <div class="modal-flower">${el.svg}</div>
    <h2>${el.name}</h2>
    <div class="modal-date">Day ${day} ‚Äî ${entry.date}</div>

    <div class="entry-view">
      <div class="activities-list">${actBadges || '<span style="font-size:12px;color:var(--text-light)">No activities</span>'}</div>
      ${entry.todayPages ? `<div class="pages-display">üìú ${entry.todayPages} pages</div>` : ''}
      ${entry.notes ? `<div class="notes-text">"${entry.notes}"</div>` : ''}
      ${entry.email ? `<div class="email-badge">‚úâÔ∏è ${entry.email}</div>` : ''}
    </div>

    <div class="modal-actions">
      <button class="btn btn-danger" onclick="deleteEntry(${day})">Remove</button>
      <button class="btn btn-secondary" onclick="editEntry(${day})">Edit</button>
      <button class="btn btn-primary" onclick="closeModal()">Close</button>
    </div>
  `;

  openModal();
}

function deleteEntry(day) {
  if(confirm(`Remove Day ${day} from your garden?`)) {
    delete entries[day];
    localStorage.setItem('quranGarden', JSON.stringify(entries));
    closeModal();
    renderGarden();
  }
}

function editEntry(day) {
  const entry = entries[day];
  closeModal();
  setTimeout(() => {
    openAddModal(day);
    setTimeout(() => {
      Object.keys(entry.activities).forEach(a => {
        if(entry.activities[a]) toggleActivity(a);
      });
      if(entry.notes) document.getElementById('entryNotes').value = entry.notes;
      if(entry.email) document.getElementById('entryEmail').value = entry.email;
      if(entry.todayPages) document.getElementById('todayPages').value = entry.todayPages;
      if(entry.elementId) {
        const opts = document.querySelectorAll('.flower-option');
        const idx = GARDEN_ELEMENTS.findIndex(e=>e.id===entry.elementId);
        if(idx >= 0 && opts[idx]) selectFlower(entry.elementId, opts[idx]);
      }
    }, 50);
  }, 200);
}

function openModal() {
  document.getElementById('modalOverlay').classList.add('open');
}

function closeModal() {
  document.getElementById('modalOverlay').classList.remove('open');
}

function closeModalOnOverlay(e) {
  if(e.target === document.getElementById('modalOverlay')) closeModal();
}

// Init
document.getElementById('totalPagesInput').value = totalPages || '';
updateKhatam();
renderGarden();
</script>
</body>
</html>
